<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ecua Radio Online | La casa de la m√∫sica ecuatoriana</title>
  <meta name="description" content="Ecua Radio Online - La casa de la m√∫sica ecuatoriana. Escucha en vivo." />

  <style>
    :root{
      --bg1:#070A12;
      --bg2:#0B1B2E;
      --card: rgba(255,255,255,.08);
      --card2: rgba(255,255,255,.06);
      --stroke: rgba(255,255,255,.14);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.7);
      --brand1:#FFD166;   /* amarillo */
      --brand2:#4CC9F0;   /* azul */
      --brand3:#EF476F;   /* rojo */
      --ok:#06D6A0;
      --shadow: 0 20px 60px rgba(0,0,0,.45);
      --radius: 22px;
      --radius2: 16px;
      --max: 1080px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Helvetica Neue";
      color: var(--text);
      background:
        radial-gradient(900px 500px at 15% 10%, rgba(76,201,240,.22), transparent 60%),
        radial-gradient(800px 480px at 85% 20%, rgba(239,71,111,.20), transparent 60%),
        radial-gradient(900px 560px at 50% 110%, rgba(255,209,102,.20), transparent 60%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      overflow-x:hidden;
    }

    /* Decorative blobs */
    .blob{
      position:absolute; inset:auto;
      filter: blur(50px);
      opacity:.45;
      z-index:0;
      border-radius:999px;
      pointer-events:none;
    }
    .b1{ width:360px;height:360px; background:rgba(76,201,240,.55); left:-120px; top:120px;}
    .b2{ width:420px;height:420px; background:rgba(239,71,111,.45); right:-160px; top:80px;}
    .b3{ width:520px;height:520px; background:rgba(255,209,102,.40); left:20%; bottom:-240px;}

    .wrap{
      position:relative;
      z-index:1;
      max-width: var(--max);
      margin: 0 auto;
      padding: 28px 16px 70px;
    }

    header{
      display:flex;
      gap:16px;
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
      margin-top: 10px;
      margin-bottom: 18px;
    }

    .brand{
      display:flex;
      align-items:center;
      gap:14px;
      min-width: 260px;
    }

   
.logo-img{
  width: 64px;
  height: 64px;
  object-fit: contain;
  border-radius: 12px;
  box-shadow: 0 14px 30px rgba(0,0,0,.35);
}
    h1{
      font-size: clamp(22px, 3.2vw, 34px);
      margin:0;
      letter-spacing:.2px;
      line-height:1.1;
    }
    .tag{
      margin:4px 0 0;
      color: var(--muted);
      font-size: 14px;
    }

    .top-actions{
      display:flex; gap:10px; align-items:center;
    }

    .btn{
      appearance:none;
      border: 1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(255,255,255,.11), rgba(255,255,255,.06));
      color: var(--text);
      padding: 10px 14px;
      border-radius: 999px;
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      box-shadow: 0 10px 25px rgba(0,0,0,.22);
      font-weight:600;
      font-size: 14px;
      display:inline-flex; gap:10px; align-items:center;
      user-select:none;
    }
    .btn:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,.24);}
    .btn:active{ transform: translateY(0px) scale(.99);}

    .btn.primary{
      border-color: rgba(255,209,102,.45);
      background: linear-gradient(180deg, rgba(255,209,102,.22), rgba(255,209,102,.10));
    }

    main{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap: 14px;
      align-items:start;
    }
    @media (max-width: 900px){
      main{ grid-template-columns: 1fr; }
    }

    .card{
      background: linear-gradient(180deg, var(--card), var(--card2));
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .player{
      padding: 18px 18px 16px;
    }
    .player-head{
      display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap;
      margin-bottom: 12px;
    }
    .now{
      display:flex; align-items:center; gap:12px;
    }
    .badge{
      padding: 6px 10px;
      border-radius: 999px;
      border:1px solid rgba(6,214,160,.35);
      background: rgba(6,214,160,.12);
      color: rgba(255,255,255,.9);
      font-weight:700;
      font-size:12px;
      letter-spacing:.2px;
      display:inline-flex; gap:8px; align-items:center;
    }
    .dot{
      width:8px;height:8px;border-radius:999px;background: var(--ok);
      box-shadow: 0 0 18px rgba(6,214,160,.6);
    }

    .controls{
      display:flex;
      gap:12px;
      align-items:center;
      flex-wrap:wrap;
      padding: 10px 0 0;
    }

    .play{
      width:58px;height:58px;
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.18);
      background:
        radial-gradient(22px 22px at 30% 30%, rgba(255,255,255,.22), transparent 60%),
        linear-gradient(135deg, rgba(76,201,240,.30), rgba(239,71,111,.20), rgba(255,209,102,.18));
      box-shadow: 0 18px 40px rgba(0,0,0,.35);
      display:grid; place-items:center;
      cursor:pointer;
      transition: transform .12s ease;
      user-select:none;
    }
    .play:hover{ transform: translateY(-1px); }
    .play:active{ transform: translateY(0px) scale(.99); }

    .icon{
      width:22px;height:22px;
      fill: rgba(255,255,255,.92);
    }

    .sliders{
      display:flex;
      gap:14px;
      align-items:center;
      flex: 1 1 260px;
      min-width: 240px;
    }

    .range{
      width:100%;
      accent-color: rgba(255,209,102,.95);
    }

    .small{
      font-size: 12.5px;
      color: var(--muted);
    }

    .status{
      margin-top: 10px;
      display:flex;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
      color: var(--muted);
      font-size: 13px;
    }

    .aside{
      padding: 18px;
    }
    .aside h2{
      margin:0 0 10px;
      font-size: 16px;
      letter-spacing:.2px;
    }
    .hint{
      color: var(--muted);
      font-size: 13px;
      line-height: 1.45;
      margin: 0 0 12px;
    }
    .mini{
      display:flex; gap:10px; flex-wrap:wrap;
    }
    .pill{
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.06);
      padding: 8px 10px;
      border-radius: 999px;
      color: rgba(255,255,255,.86);
      font-size: 13px;
    }

    .comments{
      margin-top: 14px;
      padding: 18px;
    }
    .comments h2{
      margin:0 0 10px;
      font-size: 16px;
    }
    .row{
      display:flex; gap:10px; flex-wrap:wrap;
      margin-bottom: 10px;
    }
    input, textarea{
      width: 100%;
      padding: 12px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      color: var(--text);
      outline:none;
    }
    input::placeholder, textarea::placeholder{ color: rgba(255,255,255,.55); }
    textarea{ min-height: 90px; resize: vertical; }

    .stars{
      display:flex; gap:8px; align-items:center; flex-wrap:wrap;
      padding: 10px 0 6px;
    }
    .star-btn{
      width: 40px; height: 40px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      cursor:pointer;
      display:grid; place-items:center;
      transition: transform .1s ease, border-color .1s ease;
      user-select:none;
    }
    .star-btn:hover{ transform: translateY(-1px); border-color: rgba(255,209,102,.4); }
    .star{
      width:20px; height:20px;
      fill: rgba(255,255,255,.45);
    }
    .star.on{ fill: rgba(255,209,102,.95); }

    .list{
      margin-top: 12px;
      display:grid;
      gap: 10px;
    }
    .comment{
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.14);
      border-radius: 16px;
      padding: 12px;
    }
    .comment .meta{
      display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap;
      color: var(--muted);
      font-size: 12.5px;
      margin-bottom: 6px;
    }
    .comment .text{ margin:0; color: rgba(255,255,255,.88); line-height:1.45; }

    footer{
      margin-top: 16px;
      padding: 18px;
    }
    .promo{
      display:flex;
      gap: 12px;
      align-items:flex-start;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .promo h3{
      margin:0 0 6px;
      font-size: 18px;
      letter-spacing:.2px;
    }
    .promo p{
      margin:0;
      color: var(--muted);
      line-height:1.55;
      max-width: 720px;
    }
    .whats{
      text-decoration:none;
      display:inline-flex; align-items:center; gap:10px;
      margin-top: 10px;
      padding: 10px 14px;
      border-radius: 999px;
      border: 1px solid rgba(6,214,160,.35);
      background: rgba(6,214,160,.12);
      color: rgba(255,255,255,.92);
      font-weight: 800;
      box-shadow: 0 10px 25px rgba(0,0,0,.22);
    }
    .whats:hover{ border-color: rgba(6,214,160,.55); }
    .sep{
      height:1px;
      background: rgba(255,255,255,.12);
      margin: 14px 0;
    }

    .tiny{
      margin-top: 10px;
      color: rgba(255,255,255,.55);
      font-size: 12px;
    }

    /* Accessibility focus */
    :focus-visible{
      outline: 2px solid rgba(255,209,102,.85);
      outline-offset: 3px;
      border-radius: 12px;
    }
  </style>
</head>

<body>
  <div class="blob b1"></div>
  <div class="blob b2"></div>
  <div class="blob b3"></div>

  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>Ecua Radio Online</h1>
          <div class="tag">La casa de la m√∫sica ecuatoriana</div>
        </div>
      </div>

      <div class="top-actions">
        <button id="shareBtn" class="btn primary" type="button" aria-label="Compartir Ecua Radio Online">
          <span>Compartir</span>
          <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M18 16a3 3 0 0 0-2.39 1.2L8.91 13.7a3.2 3.2 0 0 0 0-3.4l6.7-3.5A3 3 0 1 0 15 5a3 3 0 0 0 .06.6l-6.7 3.5a3 3 0 1 0 0 5.8l6.7 3.5A3 3 0 1 0 18 16z"/>
          </svg>
        </button>

        <a class="btn" href="https://wa.me/19524069260" target="_blank" rel="noopener">
          WhatsApp
          <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M12 2a10 10 0 0 0-8.6 15.1L2 22l5.1-1.3A10 10 0 1 0 12 2zm5.7 14.4c-.2.6-1 1.1-1.6 1.2-.5.1-1.1.2-3.6-.8-3-1.2-4.9-4.3-5-4.5-.1-.2-1.2-1.6-1.2-3s.7-2 1-2.3c.3-.3.6-.4.8-.4h.6c.2 0 .5 0 .7.5l1 2.3c.1.3.1.5 0 .7l-.4.6c-.1.2-.3.4-.1.7.2.3.8 1.3 1.8 2.1 1.2 1 2.2 1.3 2.6 1.4.3.1.5.1.7-.1l.8-1c.2-.2.4-.3.7-.2l2.4 1.1c.3.1.5.2.6.4.1.2.1.6 0 .9z"/>
          </svg>
        </a>
      </div>
    </header>

    <main>
      <!-- PLAYER -->
      <section class="card player" aria-label="Reproductor de Ecua Radio Online">
        <div class="player-head">
          <div class="now">
            <div class="badge"><span class="dot" aria-hidden="true"></span> EN VIVO</div>
            <div>
              <div style="font-weight:800; letter-spacing:.2px;">Escuchando: Ecua Radio Online</div>
              <div class="small">Stream listo para reproducir</div>
            </div>
          </div>
          <button id="copyLinkBtn" class="btn" type="button" title="Copiar enlace del stream">
            Copiar link
          </button>
        </div>

        <div class="controls">
          <button id="playBtn" class="play" type="button" aria-label="Reproducir / Pausar">
            <svg id="playIcon" class="icon" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M8 5v14l11-7z"></path>
            </svg>
          </button>

          <div class="sliders">
            <div style="flex:1">
              <div class="small">Volumen</div>
              <input id="vol" class="range" type="range" min="0" max="1" step="0.01" value="0.85" aria-label="Volumen" />
            </div>

            <button id="muteBtn" class="btn" type="button" aria-label="Silenciar">
              <span id="muteText">Mute</span>
              <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M3 10v4h4l5 4V6L7 10H3zm13.5 2a4.5 4.5 0 0 0-2.5-4v8a4.5 4.5 0 0 0 2.5-4zm2.5 0a7 7 0 0 1-4 6.3v-1.8a5.3 5.3 0 0 0 0-9V5.7A7 7 0 0 1 19 12z"/>
              </svg>
            </button>
          </div>
        </div>

        <div class="status">
          <div id="stateText">Estado: Pausado</div>
          <div class="small">Tip: si no suena, toca ‚ÄúPlay‚Äù otra vez (algunos m√≥viles bloquean autoplay).</div>
        </div>

        <!-- Audio -->
        <audio id="audio" preload="none" crossorigin="anonymous">
          <source src="https://sonicpanel.streamsolutions.us/8010/stream" type="audio/mpeg" />
          Tu navegador no soporta audio HTML5.
        </audio>
      </section>

      <!-- INFO / SHARE -->
      <aside class="card aside" aria-label="Informaci√≥n y opciones">
        <h2>Comparte la radio</h2>
        <p class="hint">
          Comparte esta p√°gina con tus amigos. En celulares se abre el men√∫ nativo de compartir.
          En computadoras copiar√° el enlace autom√°ticamente si no hay soporte.
        </p>

        <div class="mini">
          <span class="pill">‚úÖ F√°cil de usar</span>
          <span class="pill">üì± Responsive</span>
          <span class="pill">‚ö° Ligero</span>
          <span class="pill">üåé Ecuador vibes</span>
        </div>

        <div class="sep"></div>

        <h2>Contacto</h2>
        <p class="hint">
          ¬øQuieres a√±adir una secci√≥n de programaci√≥n, ‚ÄúTop canciones‚Äù o un chat en vivo? Se puede.
        </p>
        <a class="whats" href="https://wa.me/19524069260" target="_blank" rel="noopener">
          üì± WhatsApp: +1 952 406 9260
        </a>

        <div class="tiny">
          Sugerencia: para poner tu logo real, cambia el bloque ‚Äú.logo‚Äù por una imagen.
        </div>
      </aside>
    </main>

    <!-- COMMENTS + RATING -->
    <section class="card comments" aria-label="Comentarios y calificaci√≥n">
      <h2>Comentarios & Calificaci√≥n</h2>

      <div class="row">
        <input id="name" type="text" placeholder="Tu nombre (opcional)" aria-label="Nombre" />
      </div>

      <div class="stars" aria-label="Calificaci√≥n">
        <span class="small" style="min-width:130px;">Tu calificaci√≥n:</span>
        <button class="star-btn" data-star="1" type="button" aria-label="1 estrella">
          <svg class="star" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 17.3l-6.2 3.7 1.6-7.1L2 8.9l7.2-.6L12 1.6l2.8 6.7 7.2.6-5.4 5 1.6 7.1z"/></svg>
        </button>
        <button class="star-btn" data-star="2" type="button" aria-label="2 estrellas">
          <svg class="star" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 17.3l-6.2 3.7 1.6-7.1L2 8.9l7.2-.6L12 1.6l2.8 6.7 7.2.6-5.4 5 1.6 7.1z"/></svg>
        </button>
        <button class="star-btn" data-star="3" type="button" aria-label="3 estrellas">
          <svg class="star" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 17.3l-6.2 3.7 1.6-7.1L2 8.9l7.2-.6L12 1.6l2.8 6.7 7.2.6-5.4 5 1.6 7.1z"/></svg>
        </button>
        <button class="star-btn" data-star="4" type="button" aria-label="4 estrellas">
          <svg class="star" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 17.3l-6.2 3.7 1.6-7.1L2 8.9l7.2-.6L12 1.6l2.8 6.7 7.2.6-5.4 5 1.6 7.1z"/></svg>
        </button>
        <button class="star-btn" data-star="5" type="button" aria-label="5 estrellas">
          <svg class="star" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 17.3l-6.2 3.7 1.6-7.1L2 8.9l7.2-.6L12 1.6l2.8 6.7 7.2.6-5.4 5 1.6 7.1z"/></svg>
        </button>
        <span id="ratingText" class="small" style="margin-left:6px;">(sin calificar)</span>
      </div>

      <div class="row">
        <textarea id="msg" placeholder="Escribe tu comentario..." aria-label="Comentario"></textarea>
      </div>

      <div class="row" style="justify-content:space-between; align-items:center;">
        <button id="sendBtn" class="btn primary" type="button">Enviar</button>
        <button id="clearBtn" class="btn" type="button" title="Borrar comentarios guardados en este dispositivo">Limpiar</button>
      </div>

      <div class="list" id="list" aria-label="Lista de comentarios"></div>
    </section>

    <!-- PROMO -->
    <footer class="card" aria-label="Promoci√≥n">
      <div class="promo">
        <div>
          <h3>¬øQuieres tu propia p√°gina web?</h3>
          <p>
            Te ayudamos a crear tu p√°gina web desde cero o a mejorar la que ya tienes. Ideal para radios online,
            negocios peque√±os, proyectos personales o ideas nuevas.<br><br>
            Escr√≠benos y te orientamos paso a paso.
          </p>
          <a class="whats" href="https://wa.me/19524069260" target="_blank" rel="noopener">
            üì± WhatsApp: +1 952 406 9260
          </a>
          <div class="tiny">¬© <span id="year"></span> Ecua Radio Online</div>
        </div>
      </div>
    </footer>
  </div>

  <script>
    // ====== AUDIO PLAYER ======
    const audio = document.getElementById('audio');
    const playBtn = document.getElementById('playBtn');
    const playIcon = document.getElementById('playIcon');
    const vol = document.getElementById('vol');
    const muteBtn = document.getElementById('muteBtn');
    const muteText = document.getElementById('muteText');
    const stateText = document.getElementById('stateText');

    const STREAM_URL = "https://sonicpanel.streamsolutions.us/8010/stream";

    function setPlayIcon(isPlaying){
      playIcon.innerHTML = isPlaying
        ? '<path d="M6 5h4v14H6zm8 0h4v14h-4z"></path>'
        : '<path d="M8 5v14l11-7z"></path>';
    }

    async function togglePlay(){
      try{
        if(audio.paused){
          // Ensure source set (some browsers need it on interaction)
          if(!audio.src) audio.src = STREAM_URL;
          await audio.play();
        } else {
          audio.pause();
        }
      } catch(e){
        stateText.textContent = "Estado: No se pudo reproducir (toca Play otra vez).";
        console.warn(e);
      }
    }

    playBtn.addEventListener('click', togglePlay);

    audio.addEventListener('play', () => {
      setPlayIcon(true);
      stateText.textContent = "Estado: Reproduciendo";
    });

    audio.addEventListener('pause', () => {
      setPlayIcon(false);
      stateText.textContent = "Estado: Pausado";
    });

    vol.addEventListener('input', () => {
      audio.volume = Number(vol.value);
      if(audio.muted && audio.volume > 0){
        audio.muted = false;
        muteText.textContent = "Mute";
      }
    });

    muteBtn.addEventListener('click', () => {
      audio.muted = !audio.muted;
      muteText.textContent = audio.muted ? "Unmute" : "Mute";
    });

    // init volume
    audio.volume = Number(vol.value);

    // ====== SHARE / COPY ======
    const shareBtn = document.getElementById('shareBtn');
    const copyLinkBtn = document.getElementById('copyLinkBtn');

    function getShareData(){
      return {
        title: "Ecua Radio Online",
        text: "Ecua Radio Online - La casa de la m√∫sica ecuatoriana. Escucha en vivo.",
        url: window.location.href
      };
    }

    async function copyText(text){
      try{
        await navigator.clipboard.writeText(text);
        return true;
      }catch(e){
        // fallback
        const t = document.createElement('textarea');
        t.value = text;
        document.body.appendChild(t);
        t.select();
        const ok = document.execCommand('copy');
        document.body.removeChild(t);
        return ok;
      }
    }

    shareBtn.addEventListener('click', async () => {
      const data = getShareData();
      if(navigator.share){
        try{
          await navigator.share(data);
        }catch(e){
          // user canceled or not available
        }
      } else {
        const ok = await copyText(data.url);
        shareBtn.textContent = ok ? "‚úÖ Enlace copiado" : "‚ùå No se pudo copiar";
        setTimeout(() => shareBtn.innerHTML = 'Compartir <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M18 16a3 3 0 0 0-2.39 1.2L8.91 13.7a3.2 3.2 0 0 0 0-3.4l6.7-3.5A3 3 0 1 0 15 5a3 3 0 0 0 .06.6l-6.7 3.5a3 3 0 1 0 0 5.8l6.7 3.5A3 3 0 1 0 18 16z"/></svg>', 1400);
      }
    });

    copyLinkBtn.addEventListener('click', async () => {
      const ok = await copyText(STREAM_URL);
      copyLinkBtn.textContent = ok ? "‚úÖ Copiado" : "‚ùå Error";
      setTimeout(() => copyLinkBtn.textContent = "Copiar link", 1200);
    });

    // ====== COMMENTS + RATING (LocalStorage) ======
    const nameEl = document.getElementById('name');
    const msgEl = document.getElementById('msg');
    const sendBtn = document.getElementById('sendBtn');
    const clearBtn = document.getElementById('clearBtn');
    const listEl = document.getElementById('list');
    const ratingText = document.getElementById('ratingText');
    const starBtns = Array.from(document.querySelectorAll('.star-btn'));

    let currentRating = 0;
    const KEY = "ecua_radio_comments_v1";

    function loadComments(){
      try{
        return JSON.parse(localStorage.getItem(KEY) || "[]");
      }catch(e){
        return [];
      }
    }
    function saveComments(arr){
      localStorage.setItem(KEY, JSON.stringify(arr));
    }

    function formatDate(ts){
      const d = new Date(ts);
      return d.toLocaleString();
    }

    function renderStars(){
      starBtns.forEach(btn => {
        const n = Number(btn.dataset.star);
        const svg = btn.querySelector('svg');
        if(n <= currentRating) svg.classList.add('on');
        else svg.classList.remove('on');
      });
      ratingText.textContent = currentRating ? `(${currentRating}/5)` : "(sin calificar)";
    }

    starBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        currentRating = Number(btn.dataset.star);
        renderStars();
      });
    });

    function renderList(){
      const data = loadComments().slice().reverse();
      if(!data.length){
        listEl.innerHTML = `<div class="comment"><div class="meta">A√∫n no hay comentarios</div><p class="text">S√© el primero en dejar tu mensaje üôå</p></div>`;
        return;
      }

      listEl.innerHTML = data.map(item => {
        const stars = "‚òÖ".repeat(item.rating || 0) + "‚òÜ".repeat(5 - (item.rating || 0));
        const safeName = (item.name || "An√≥nimo").replace(/[<>]/g,"");
        const safeMsg = (item.message || "").replace(/[<>]/g,"");
        return `
          <div class="comment">
            <div class="meta">
              <div><strong>${safeName}</strong> ¬∑ <span>${formatDate(item.ts)}</span></div>
              <div style="letter-spacing:.4px; color:rgba(255,209,102,.95)">${stars}</div>
            </div>
            <p class="text">${safeMsg}</p>
          </div>
        `;
      }).join("");
    }

    sendBtn.addEventListener('click', () => {
      const message = msgEl.value.trim();
      if(!message){
        msgEl.focus();
        return;
      }
      const arr = loadComments();
      arr.push({
        name: nameEl.value.trim(),
        message,
        rating: currentRating,
        ts: Date.now()
      });
      saveComments(arr);
      msgEl.value = "";
      currentRating = 0;
      renderStars();
      renderList();
    });

    clearBtn.addEventListener('click', () => {
      localStorage.removeItem(KEY);
      renderList();
    });

    // init
    document.getElementById('year').textContent = new Date().getFullYear();
    renderStars();
    renderList();
  </script>
</body>
</html>
