<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Ecua Radio Online</title>
  <meta name="description" content="La casa de la mÃºsica ecuatoriana" />
  <meta name="theme-color" content="#d60000" />

  <!-- PWA -->
  <link rel="manifest" href="manifest.json" />
  <link rel="apple-touch-icon" href="icon.png" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

  <style>
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(circle at top, #6b39ff, #141b3b 60%, #0b1025);
      color:#fff;
      display:flex;
      justify-content:center;
      padding:24px 14px 60px;
    }
    .wrap{ width: min(720px, 100%); }
    .hero{
      background: linear-gradient(135deg, rgba(255,255,255,0.08), rgba(255,255,255,0.03));
      border:1px solid rgba(255,255,255,0.10);
      border-radius:22px;
      padding:22px;
      text-align:center;
      box-shadow: 0 10px 30px rgba(0,0,0,0.25);
    }
    h1{ margin:0; font-size:42px; line-height:1.05; }
    .sub{ opacity:.85; margin-top:10px; font-size:18px; }

    .card{
      margin-top:18px;
      background: rgba(8, 14, 33, 0.65);
      border:1px solid rgba(255,255,255,0.10);
      border-radius:22px;
      padding:18px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.25);
    }

    .btn{
      width:100%;
      border:0;
      border-radius:14px;
      padding:14px 16px;
      font-size:18px;
      font-weight:700;
      cursor:pointer;
    }

    .liveBtn{
      background: #ffffff;
      color:#0f1733;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:10px;
    }

    .dot{
      width:10px; height:10px; border-radius:999px;
      background:#d60000;
      box-shadow: 0 0 0 6px rgba(214,0,0,0.15);
      animation: pulse 1.2s infinite;
    }
    @keyframes pulse{
      0%{ transform:scale(1); opacity:1; }
      50%{ transform:scale(1.15); opacity:.75; }
      100%{ transform:scale(1); opacity:1; }
    }

    .installBtn{
      background:#e6e6e6;
      color:#0f1733;
      font-weight:700;
      margin-top:14px;
      display:none;
    }

    .note{
      margin-top:12px;
      font-size:14px;
      opacity:.85;
      line-height:1.35;
    }

    .row{
      display:flex;
      gap:12px;
      margin-top:14px;
      flex-wrap:wrap;
    }
    .small{
      flex:1 1 220px;
      background: rgba(255,255,255,0.06);
      border:1px solid rgba(255,255,255,0.10);
      border-radius:16px;
      padding:14px;
    }
    .small h3{ margin:0 0 6px 0; font-size:16px; }
    .small p{ margin:0; opacity:.85; }
  </style>
</head>

<body>
  <div class="wrap">

    <div class="hero">
      <h1>Ecua Radio<br/>Online</h1>
      <div class="sub">La casa de la mÃºsica ecuatoriana</div>
    </div>

    <div class="card">
      <!-- BOTON EN VIVO -->
      <button id="playButton" class="btn liveBtn">
        <span class="dot" aria-hidden="true"></span>
        <span id="playText">ESCUCHAR EN VIVO</span>
      </button>

      <!-- BOTON INSTALAR (Android/Chrome) -->
      <button id="installBtn" class="btn installBtn">ðŸ“² Instalar EcuaRadio</button>

      <div class="note" id="helpText">
        âœ… En iPhone: toca el botÃ³n de compartir â†’ <b>Agregar a pantalla de inicio</b> para instalar la App Web.<br/>
        âœ… En Android: aparecerÃ¡ el botÃ³n <b>Instalar EcuaRadio</b>.
      </div>

      <!-- AUDIO -->
      <audio id="player" playsinline preload="none">
        <source src="https://sonicpanel.streamsolutions.us/8010/stream" type="audio/mpeg" />
        Tu navegador no soporta audio HTML5.
      </audio>

      <div class="row">
        <div class="small">
          <h3>ðŸ“» Consejo</h3>
          <p>En iPhone, si no suena, toca el botÃ³n una vez mÃ¡s (Safari a veces bloquea el primer play).</p>
        </div>
        <div class="small">
          <h3>âš¡ App Web</h3>
          <p>Esta pÃ¡gina es instalable como app. No necesitas App Store.</p>
        </div>
      </div>
    </div>

  </div>

  <script>
    // ======= RADIO PLAY/PAUSE (iPhone + Android) =======
    document.addEventListener('DOMContentLoaded', () => {
      const playButton = document.getElementById('playButton');
      const playText = document.getElementById('playText');
      const radio = document.getElementById('player');

      if (!playButton || !radio) return;

      async function startRadio() {
        // fuerza recarga del stream
        try { radio.load(); } catch(e) {}
        await radio.play();
        playText.textContent = 'PAUSAR TRANSMISIÃ“N';
      }

      function stopRadio() {
        radio.pause();
        playText.textContent = 'ESCUCHAR EN VIVO';
      }

      playButton.addEventListener('click', async () => {
        try {
          if (radio.paused) {
            await startRadio();
          } else {
            stopRadio();
          }
        } catch (err) {
          alert('Toca otra vez para activar el audio (Safari a veces lo bloquea).');
          console.error(err);
        }
      });
    });

    // ======= PWA: SERVICE WORKER =======
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js');
    }

    // ======= PWA: BOTON INSTALAR (Android/Chrome) =======
    let deferredPrompt;
    const installBtn = document.getElementById('installBtn');

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      if (installBtn) installBtn.style.display = 'block';
    });

    if (installBtn) {
      installBtn.addEventListener('click', async () => {
        if (!deferredPrompt) return;
        deferredPrompt.prompt();
        await deferredPrompt.userChoice;
        deferredPrompt = null;
        installBtn.style.display = 'none';
      });
    }
  </script>
</body>
</html>
